<html>
<head>
<title>Hoos Map</title>
<script type="text/javascript" src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=ABQIAAAAvdV_C7EiC5qvYhizkNRvmxQ_pFa7EbBvItR2syiehiKCeylqUhSqRWNiI9G0u5Zlh8ZrT-4fScLzTw"></script>
<script type="text/javascript" src="/jquery.min.js"></script> 
<script type="text/javascript" src="/direction.js"></script> 
<script type="text/javascript">
/*$(document).ready(function() {

   $("input").bind("keydown", function(event) {
      // track enter key
      var keycode = (event.keyCode ? event.keyCode : (event.which ? event.which : event.charCode));
      if (keycode == 13) { // keycode for enter key
         // force the 'Enter Key' to implicitly click the Update button
         document.getElementById('ShowMapButton').click();
         return false;
      } else  {
         return true;
      }
   }); // end of function

}); // end of document ready
*/
var direction = new Direction();
var map;


function showDirections()
{
    form = document.getElementById("TheForm");
    var Start = form.StartingAddress.value;
    var End = form.Destination.value;
    if(!Start || !End)
    {
        return;
    }
    //Ajax request for starting point
    jQuery.ajax({
    dataType: 'jsonp',
    url: 'http://maps.google.com/maps/geo?q=' + Start + '&output=json&sensor=true&key=ABQIAAAAvdV_C7EiC5qvYhizkNRvmxQ_pFa7EbBvItR2syiehiKCeylqUhSqRWNiI9G0u5Zlh8ZrT-4fScLzTw',
    cache: false,
    success: function(data){
      //Will do this code when the request is successful
      if(data.Status.code==200) {
        direction.setStartLocation([data.Placemark[0].Point.coordinates[1],data.Placemark[0].Point.coordinates[0]]);
        var Start = new GLatLng(direction.getStartLocation()[0],direction.getStartLocation()[1]);
        map.addOverlay(new GMarker(Start));
      }
    } 
  })
  
    //Ajax request for ending point
    jQuery.ajax({
    dataType: 'jsonp',
    url: 'http://maps.google.com/maps/geo?q=' + End + '&output=json&sensor=true&key=ABQIAAAAvdV_C7EiC5qvYhizkNRvmxQ_pFa7EbBvItR2syiehiKCeylqUhSqRWNiI9G0u5Zlh8ZrT-4fScLzTw',
    cache: false,
    success: function(data){
      if(data.Status.code==200) {
        //Will do this code when the request is successful
        direction.setEndLocation([data.Placemark[0].Point.coordinates[1],data.Placemark[0].Point.coordinates[0]]);
        var End = new GLatLng(direction.getEndLocation()[0],direction.getEndLocation()[1]);
        map.addOverlay(new GMarker(End));

        //gets directions
        direction.getDirections();
		aert('here');
		walkingDirections = dirction.getDirectionRequests('just_walking');
		alert(walkingDirections);
      }
    }
  })
}

function showMap() {
    if(GBrowserIsCompatible())
    {
        map = new GMap2(document.getElementById("map_canvas"));
        map.setUIToDefault();

        //Sets Center to UVA
        map.setCenter(new GLatLng(38.034453,-78.51781),13);
      
        /*
        This is the starting code for using current location with mobile
        devices:
        if(google.loader.ClientLocation && google.loader.ClientLocation.address.country_code == "US")
        {
            map.setCenter(new GLatLng(google.loader.ClientLocation.latitude, google.loader.ClientLocation.longitude), 13);
        }
        else
        {
            map.setCenter(new GLatLng(36.697011,-79.870984),13);
        }*/
    };

}
</script>
</head>
<body>
<h1><center>HoosMap</center></h1>
<h3><center>"Surprisingly Witty!"</center></h3>
<form id="TheForm" method="post" action="" name="TheForm" onSubmit="return false">
Enter Your Starting Address.<br><input type=text name="StartingAddress" value=""><br>
Enter Your Destination.<br><input type=text name="Destination" value=""><br><br>
Your approximate walking time is: <div id="walking_time"> </div> <br>
Your approximate bus time is: <div id="bus_time"> </div></div> <br>
<br>
<input type=button name="button1" id="ShowDirectionsButton" value="Show Directions" onClick="showDirections()">
<br><br><input type=button name="button2" id="ShowMapButton" value="Build Map" onClick="showMap()">
<br>
<div id="map_canvas" style="width: 75%; height: 500px; float: left;"></div><div id="map_canvas" style="width: 25%; height: 500px; float: right; border=1px;"></div>
<div id="directions_panel">
</div>
</form>
</body>
</html>
