<html>
<head>
<title>Hoos Map</title>
<script type="text/javascript" src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=ABQIAAAAvdV_C7EiC5qvYhizkNRvmxQ_pFa7EbBvItR2syiehiKCeylqUhSqRWNiI9G0u5Zlh8ZrT-4fScLzTw"></script>
<script type="text/javascript" src="/home/rsingh/Desktop/cs-final/public/jquery.min.js"></script> 
<script type="text/javascript" src="/home/rsingh/Desktop/cs-final/public/direction.js"></script> 
<script type="text/javascript">
$(document).ready(function() {
})
var direction = new Direction();
  var map;
showMap();
function getCoords (form) {
    var Start = form.StartingAddress.value;
    var End = form.Destination.value;
    if(!Start || !End)
    {
        return;
    }
    //Ajax request for starting point
    jQuery.ajax({
    dataType: 'jsonp',
    url: 'http://maps.google.com/maps/geo?q=' + Start + '&output=json&sensor=true&key=ABQIAAAAvdV_C7EiC5qvYhizkNRvmxQ_pFa7EbBvItR2syiehiKCeylqUhSqRWNiI9G0u5Zlh8ZrT-4fScLzTw',
    cache: false,
    success: function(data){
      if(data.Status.code==200) {
        direction.setStartLocation([data.Placemark[0].Point.coordinates[1],data.Placemark[0].Point.coordinates[0]]);
        var Start = new GLatLng(direction.getStartLocation()[0],direction.getStartLocation()[1]);
        map.addOverlay(new GMarker(Start));
      }
    } 
  })
  
    //Ajax request for ending point
    jQuery.ajax({
    dataType: 'jsonp',
    url: 'http://maps.google.com/maps/geo?q=' + End + '&output=json&sensor=true&key=ABQIAAAAvdV_C7EiC5qvYhizkNRvmxQ_pFa7EbBvItR2syiehiKCeylqUhSqRWNiI9G0u5Zlh8ZrT-4fScLzTw',
    cache: false,
    success: function(data){
      if(data.Status.code==200) {
        direction.setEndLocation([data.Placemark[0].Point.coordinates[1],data.Placemark[0].Point.coordinates[0]]);
        var End = new GLatLng(direction.getEndLocation()[0],direction.getEndLocation()[1]);
        map.addOverlay(new GMarker(End));
      }
    }
  })
}

function showDirections()
{
    getCoords(document.getElementById("TheForm"));
}

function showMap() {
    if(GBrowserIsCompatible())
    {
        map = new GMap2(document.getElementById("map_canvas"));
        map.setUIToDefault();

        //Sets Center to UVA
        map.setCenter(new GLatLng(38.034453,-78.51781),13);
      
        /*
        This is the starting code for using current location with mobile
        devices:
        if(google.loader.ClientLocation && google.loader.ClientLocation.address.country_code == "US")
        {
            map.setCenter(new GLatLng(google.loader.ClientLocation.latitude, google.loader.ClientLocation.longitude), 13);
        }
        else
        {
            map.setCenter(new GLatLng(36.697011,-79.870984),13);
        }*/

    }

}

</script>
</head>
<body>
<script type="text/javascript">
</script>

<form id="TheForm" name="TheForm" action="" method="GET">
Enter Your Starting Address.<br><input type=text name="StartingAddress" value=""><br>
Enter Your Destination.<br><input type=text name="Destination" value="">
<br><input type=button name="button" value="Go" onClick="GetCoords(this.form)"><br><input type=button name="button" value="Build Map" onClick="showMap()">
<br>
<input type=button name="button" value="Show Directions" onClick="showDirections()">
<div id="map_canvas" style="width: 75%; height: 500px; float: left;"></div><div id="map_canvas" style="width: 25%; height: 500px; float: right; border=1px;"></div>
</form>
</body>
</html>
